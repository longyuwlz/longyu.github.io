"use strict";(self.webpackChunklongyu_website=self.webpackChunklongyu_website||[]).push([[8246],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return b}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=d(e,["components","mdxType","originalType","parentName"]),g=s(n),b=r,m=g["".concat(l,".").concat(b)]||g[b]||c[b]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=g;var d={};for(var l in t)hasOwnProperty.call(t,l)&&(d[l]=t[l]);d.originalType=e,d.mdxType="string"==typeof e?e:r,i[1]=d;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},906:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return b},frontMatter:function(){return d},metadata:function(){return s},toc:function(){return c}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],d={},l="\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",s={unversionedId:"\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",id:"\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",title:"\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",description:"\u6267\u884c apt-get download dpkg \u4e0b\u8f7d dpkg \u7a0b\u5e8f\u7684 deb \u5305\uff1a",source:"@site/docs/\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b.md",sourceDirName:"\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb",slug:"/\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",permalink:"/longyu.github.io/\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",draft:!1,editUrl:"https://github.com/longyuwlz/longyu.github.io/docs/\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"dpkg \u547d\u4ee4\u5206\u6790\u4e4b /var/lib/dpkg \u76ee\u5f55",permalink:"/longyu.github.io/\u6280\u672f\u535a\u5ba2/linux-system/\u5305\u7ba1\u7406\u7cfb\u7edf/deb/dpkg \u91cd\u8981\u76ee\u5f55\u5206\u6790"},next:{title:"bash \u4e2d\u6355\u83b7\u6bcf\u4e00\u4e2a\u8f93\u5165\u5b57\u7b26\u5982\u4f55\u5b9e\u73b0\uff1f",permalink:"/longyu.github.io/\u6280\u672f\u535a\u5ba2/linux-system/\u547d\u4ee4\u5b9e\u73b0\u539f\u7406\u5206\u6790/bash \u4e2d\u6355\u83b7\u6bcf\u4e00\u4e2a\u8f93\u5165\u5b57\u7b26\u5982\u4f55\u5b9e\u73b0\uff1f"}},p={},c=[{value:"dpkg-deb \u547d\u4ee4",id:"dpkg-deb-\u547d\u4ee4",level:2},{value:"dpkg-deb -c \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--c-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb -e \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--e-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb -x \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--x-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb -X \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--x-\u6267\u884c\u793a\u4f8b-1",level:3},{value:"dpkg-deb -f \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--f-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb --ctrl-tarfile \u6267\u884c\u793a\u4f8b",id:"dpkg-deb---ctrl-tarfile-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb --fsys-tarfile \u6267\u884c\u793a\u4f8b",id:"dpkg-deb---fsys-tarfile-\u6267\u884c\u793a\u4f8b",level:3},{value:"dpkg-deb -I \u6267\u884c\u793a\u4f8b",id:"dpkg-deb--i-\u6267\u884c\u793a\u4f8b",level:3},{value:"\u4ee5 dpkg deb \u5305\u4e3a\u4f8b\uff0c\u67e5\u770b deb \u5305\u771f\u5b9e\u5185\u5bb9",id:"\u4ee5-dpkg-deb-\u5305\u4e3a\u4f8b\u67e5\u770b-deb-\u5305\u771f\u5b9e\u5185\u5bb9",level:2},{value:"1. \u4f7f\u7528 ar \u547d\u4ee4\u89e3\u538b deb \u5305",id:"1-\u4f7f\u7528-ar-\u547d\u4ee4\u89e3\u538b-deb-\u5305",level:3},{value:"2. \u67e5\u770b debian-binary \u6587\u4ef6\u5185\u5bb9",id:"2-\u67e5\u770b-debian-binary-\u6587\u4ef6\u5185\u5bb9",level:3},{value:"3. \u67e5\u770b control.tar.xz \u6587\u4ef6\u5185\u5bb9",id:"3-\u67e5\u770b-controltarxz-\u6587\u4ef6\u5185\u5bb9",level:3},{value:"3.1 conffiles \u6587\u4ef6\u5185\u5bb9",id:"31-conffiles-\u6587\u4ef6\u5185\u5bb9",level:4},{value:"3.2 control \u6587\u4ef6\u5185\u5bb9",id:"32-control-\u6587\u4ef6\u5185\u5bb9",level:4},{value:"3. md5sums \u6587\u4ef6\u5185\u5bb9",id:"3-md5sums-\u6587\u4ef6\u5185\u5bb9",level:4},{value:"4. postinst \u6587\u4ef6\u5185\u5bb9",id:"4-postinst-\u6587\u4ef6\u5185\u5bb9",level:4},{value:"5. postrm \u6587\u4ef6\u5185\u5bb9",id:"5-postrm-\u6587\u4ef6\u5185\u5bb9",level:4},{value:"data.tar \u6587\u4ef6\u5185\u5bb9",id:"datatar-\u6587\u4ef6\u5185\u5bb9",level:3},{value:"dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",id:"dpkg-\u5b89\u88c5\u5305\u7684\u8fc7\u7a0b",level:2}],g={toc:c};function b(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"\u4ece-dpkg-deb-\u5305\u5f00\u59cb\u5206\u6790-deb-\u5305\u7684\u5185\u5bb9\u53ca-dpkg-\u5b89\u88c5\u5305\u7684\u8fc7\u7a0b"},"\u4ece dpkg deb \u5305\u5f00\u59cb\u5206\u6790 deb \u5305\u7684\u5185\u5bb9\u53ca dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b"),(0,o.kt)("h1",{id:"\u4e0b\u8f7d-dpkg-deb-\u5305"},"\u4e0b\u8f7d dpkg deb \u5305"),(0,o.kt)("p",null,"\u6267\u884c apt-get download dpkg \u4e0b\u8f7d dpkg \u7a0b\u5e8f\u7684 deb \u5305\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"longyu@virt-debian10:/tmp$ sudo apt-get download dpkg\nlongyu@virt-debian10:/tmp$ ls -lh ./dpkg_1.19.7_amd64.deb \n-rw-r--r-- 1 root root 2.2M 6\u6708   4  2019 ./dpkg_1.19.7_amd64.deb\n")),(0,o.kt)("p",null,"1.19.7 \u4e3a dpkg \u5305\u7684\u7248\u672c\uff0camd64 \u8868\u793a\u5305\u9002\u7528\u7684\u67b6\u6784\u3002"),(0,o.kt)("h1",{id:"deb-\u7684\u5185\u5bb9"},"deb \u7684\u5185\u5bb9"),(0,o.kt)("p",null,"file deb \u5305\u793a\u4f8b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"longyu@virt-debian10:/tmp$ file ./dpkg_1.19.7_amd64.deb \n./dpkg_1.19.7_amd64.deb: Debian binary package (format 2.0)\n")),(0,o.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u793a\u4f8b\u4e2d deb \u5305\u4e3a 2.0 \u683c\u5f0f\u7684 Debian \u4e8c\u8fdb\u5236\u5305\u3002"),(0,o.kt)("p",null,"man deb \u83b7\u53d6\u5230\u7684\u91cd\u8981\u4fe1\u606f\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-manual"},"FORMAT\n       The file is an ar archive with a magic value of !<arch>.  Only the common ar archive format is supported, with no long file name extensions, but with file  names\n       containing  an  optional  trailing  slash,  which limits their length to 15 characters (from the 16 allowed).  File sizes are limited to 10 ASCII decimal digits,\n       allowing for up to approximately 9536.74 MiB member files.\n\n       The tar archives currently allowed are, the old-style (v7) format, the pre-POSIX ustar format, a subset of the GNU format (new  style  long  pathnames  and  long\n       linknames,  supported  since  dpkg  1.4.1.17;  large  file  metadata  since  dpkg  1.18.24), and the POSIX ustar format (long names supported since dpkg 1.15.0).\n       Unrecognized tar typeflags are considered an error.  Each tar entry size inside a tar archive is limited to 11 ASCII octal digits, allowing for up to 8  GiB  tar\n       entries.  The GNU large file metadata support permits 95-bit tar entry sizes and negative timestamps, and 63-bit UID, GID and device numbers.\n\n       The first member is named debian-binary and contains a series of lines, separated by newlines. Currently only one line is present, the format version number, 2.0\n       at the time this manual page was written.  Programs which read new-format archives should be prepared for the minor number to be increased and new  lines  to  be\n       present, and should ignore these if this is the case.\n\n       If  the  major  number  has  changed,  an incompatible change has been made and the program should stop. If it has not, then the program should be able to safely\n       continue, unless it encounters an unexpected member in the archive (except at the end), as described below.\n\n       The second required member is named control.tar.  It is a tar archive containing the package control information, either not  compressed  (supported  since  dpkg\n       1.17.6),  or  compressed with gzip (with .gz extension) or xz (with .xz extension, supported since 1.17.6), as a series of plain files, of which the file control\n       is mandatory and contains the core control information, the conffiles, triggers, shlibs and symbols files contain optional control information, and the  preinst,\n       postinst, prerm and postrm files are optional maintainer scripts.  The control tarball may optionally contain an entry for \u2018.\u2019, the current directory.\n\n       The  third,  last  required  member  is  named  data.tar.   It contains the filesystem as a tar archive, either not compressed (supported since dpkg 1.10.24), or\n       compressed with gzip (with .gz extension), xz (with .xz extension, supported since dpkg 1.15.6), bzip2 (with .bz2 extension, supported  since  dpkg  1.10.24)  or\n       lzma (with .lzma extension, supported since dpkg 1.13.25).\n\n       These members must occur in this exact order. Current implementations should ignore any additional members after data.tar.  Further members may be defined in the\n       future, and (if possible) will be placed after these three. Any additional members that may need to be inserted after debian-binary  and  before  control.tar  or\n       data.tar and which should be safely ignored by older programs, will have names starting with an underscore, \u2018_\u2019.\n\n       Those  new  members  which won't be able to be safely ignored will be inserted before data.tar with names starting with something other than underscores, or will\n       (more likely) cause the major version number to be increased.\n")),(0,o.kt)("p",null,"\u4e0a\u8ff0\u63cf\u8ff0\u8868\u660e deb \u5305\u662f\u4e00\u4e2a\u5e26\u6709\u9b54\u672f\u503c ",(0,o.kt)("inlineCode",{parentName:"p"},"!<arch>")," \u7684 ar \u5305\u3002\u5b83\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"debian-binary"),(0,o.kt)("li",{parentName:"ol"},"control.tar"),(0,o.kt)("li",{parentName:"ol"},"data.tar")),(0,o.kt)("p",null,"debian-binary \u4e2d\u5b58\u653e\u4e86 deb \u683c\u5f0f\u7248\u672c\u53f7\uff0c\u76ee\u524d\u662f 2.0 \u7248\u672c\u3002"),(0,o.kt)("p",null,"control.tar \u5b58\u50a8\u5305\u7684\u63a7\u5236\u4fe1\u606f\u3002\u5b83\u6253\u5305\u4e86 coffiles\u3001triggers\u3001shlibs\u3001symbols \u7b49\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5305\u542b\u53ef\u9009\u7684\u63a7\u5236\u4fe1\u606f\uff0c\u4e5f\u6253\u5305\u4e86 preinst\u3001postinst\u3001prerm\u3001postrm \u7b49\u53ef\u9009\u7684\u90e8\u7f72\u811a\u672c\u3002"),(0,o.kt)("p",null,"data.tar \u662f\u5b89\u88c5\u6587\u4ef6\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684 tar \u5305\u3002"),(0,o.kt)("p",null,"\u8fd9\u4e09\u9879\u7684\u987a\u5e8f\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u53ef\u98a0\u5012\u3002\u5f53\u524d\u7684\u5b9e\u73b0\u4f1a\u5ffd\u7565 data.tar \u4e4b\u540e\u7684\u5185\u5bb9\u3002"),(0,o.kt)("h2",{id:"dpkg-deb-\u547d\u4ee4"},"dpkg-deb \u547d\u4ee4"),(0,o.kt)("p",null,"dpdk-deb \u547d\u4ee4\u7528\u4e8e\u5904\u7406 deb \u5305\uff0cmanual \u4e2d\u63cf\u8ff0\u7684\u529f\u80fd\u5982\u4e0b\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"       dpkg-deb actions\n              See dpkg-deb(1) for more information about the following actions.\n\n              -b, --build directory [archive|directory]\n                  Build a deb package.\n              -c, --contents archive\n                  List contents of a deb package.\n              -e, --control archive [directory]\n                  Extract control-information from a package.\n              -x, --extract archive directory\n                  Extract the files contained by package.\n              -X, --vextract archive directory\n                  Extract and display the filenames contained by a\n                  package.\n              -f, --field  archive [control-field...]\n                  Display control field(s) of a package.\n              --ctrl-tarfile archive\n                  Output the control tar-file contained in a Debian package.\n              --fsys-tarfile archive\n                  Output the filesystem tar-file contained by a Debian package.\n              -I, --info archive [control-file...]\n                  Show information about a package.\n")),(0,o.kt)("h3",{id:"dpkg-deb--c-\u6267\u884c\u793a\u4f8b"},"dpkg-deb -c \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp# dpkg-deb  -c ./dpkg_1.19.7_amd64.deb \ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/alternatives/\n-rw-r--r-- root/root       100 2019-06-04 05:22 ./etc/alternatives/README\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/cron.daily/\n-rwxr-xr-x root/root      1187 2019-04-19 10:14 ./etc/cron.daily/dpkg\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/dpkg/\n-rw-r--r-- root/root       446 2014-11-28 09:08 ./etc/dpkg/dpkg.cfg\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/dpkg/dpkg.cfg.d/\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/logrotate.d/\n-rw-r--r-- root/root       120 2019-04-19 10:14 ./etc/logrotate.d/alternatives\n-rw-r--r-- root/root       112 2019-04-19 10:14 ./etc/logrotate.d/dpkg\n")),(0,o.kt)("h3",{id:"dpkg-deb--e-\u6267\u884c\u793a\u4f8b"},"dpkg-deb -e \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb  -e ./dpkg_1.19.7_amd64.deb \nroot@virt-debian10:/tmp/test# ls\nDEBIAN  dpkg_1.19.7_amd64.deb\nroot@virt-debian10:/tmp/test# cat DEBIAN/\nconffiles  control    md5sums    postinst   postrm  \n")),(0,o.kt)("h3",{id:"dpkg-deb--x-\u6267\u884c\u793a\u4f8b"},"dpkg-deb -x \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb  -x ./dpkg_1.19.7_amd64.deb  ./package\nroot@virt-debian10:/tmp/test# ls ./package/\netc  sbin  usr  var\n")),(0,o.kt)("h3",{id:"dpkg-deb--x-\u6267\u884c\u793a\u4f8b-1"},"dpkg-deb -X \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb -X ./dpkg_1.19.7_amd64.deb  package\n./\n./etc/\n./etc/alternatives/\n./etc/alternatives/README\n./etc/cron.daily/\n./etc/cron.daily/dpkg\n./etc/dpkg/\n./etc/dpkg/dpkg.cfg\n./etc/dpkg/dpkg.cfg.d/\n./etc/logrotate.d/\n./etc/logrotate.d/alternatives\n./etc/logrotate.d/dpkg\n.........\n")),(0,o.kt)("h3",{id:"dpkg-deb--f-\u6267\u884c\u793a\u4f8b"},"dpkg-deb -f \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb -f ./dpkg_1.19.7_amd64.deb \nPackage: dpkg\nVersion: 1.19.7\nArchitecture: amd64\nEssential: yes\nMaintainer: Dpkg Developers <debian-dpkg@lists.debian.org>\nInstalled-Size: 6693\nPre-Depends: libbz2-1.0, libc6 (>= 2.15), liblzma5 (>= 5.2.2), libselinux1 (>= 2.3), zlib1g (>= 1:1.1.4)\nDepends: tar (>= 1.28-1)\nSuggests: apt, debsig-verify\nBreaks: acidbase (<= 1.4.5-4), amule (<< 2.3.1+git1a369e47-3), beep (<< 1.3-4), im (<< 1:151-4), libapt-pkg5.0 (<< 1.7~b), libdpkg-perl (<< 1.18.11), lsb-base (<< 10.2019031300), netselect (<< 0.3.ds1-27), pconsole (<< 1.0-12), phpgacl (<< 3.3.7-7.3), pure-ftpd (<< 1.0.43-1), systemtap (<< 2.8-1), terminatorx (<< 4.0.1-1), xvt (<= 2.1-20.1)\nSection: admin\nPriority: required\nMulti-Arch: foreign\nHomepage: https://wiki.debian.org/Teams/Dpkg\nDescription: Debian package management system\n This package provides the low-level infrastructure for handling the\n installation and removal of Debian software packages.\n .\n For Debian package development tools, install dpkg-dev.\n")),(0,o.kt)("h3",{id:"dpkg-deb---ctrl-tarfile-\u6267\u884c\u793a\u4f8b"},"dpkg-deb --ctrl-tarfile \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb --ctrl-tarfile ./dpkg_1.19.7_amd64.deb > control.tar\nroot@virt-debian10:/tmp/test# tar -tvf ./control.tar \ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./\n-rw-r--r-- root/root       117 2019-06-04 05:22 ./conffiles\n-rw-r--r-- root/root       976 2019-06-04 05:22 ./control\n-rw-r--r-- root/root      8877 2019-06-04 05:22 ./md5sums\n-rwxr-xr-x root/root       789 2019-06-04 05:22 ./postinst\n-rwxr-xr-x root/root       498 2019-06-04 05:22 ./postrm\n")),(0,o.kt)("h3",{id:"dpkg-deb---fsys-tarfile-\u6267\u884c\u793a\u4f8b"},"dpkg-deb --fsys-tarfile \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb --fsys-tarfile ./dpkg_1.19.7_amd64.deb > data.tar\nroot@virt-debian10:/tmp/test# tar -tvf ./data.tar\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/alternatives/\n-rw-r--r-- root/root       100 2019-06-04 05:22 ./etc/alternatives/README\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/cron.daily/\n-rwxr-xr-x root/root      1187 2019-04-19 10:14 ./etc/cron.daily/dpkg\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/dpkg/\n.........\n")),(0,o.kt)("h3",{id:"dpkg-deb--i-\u6267\u884c\u793a\u4f8b"},"dpkg-deb -I \u6267\u884c\u793a\u4f8b"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# dpkg-deb -I ./dpkg_1.19.7_amd64.deb \n \u65b0\u683c\u5f0f\u7684 Debian \u8f6f\u4ef6\u5305\uff0c\u683c\u5f0f\u7248\u672c 2.0\u3002\n \u5927\u5c0f 2208136 \u5b57\u8282\uff1a\u4e3b\u63a7\u5305=4424 \u5b57\u8282\u3002\n     117 \u5b57\u8282\uff0c    5 \u884c      conffiles            \n     976 \u5b57\u8282\uff0c   19 \u884c      control              \n    8877 \u5b57\u8282\uff0c  123 \u884c      md5sums              \n     789 \u5b57\u8282\uff0c   46 \u884c   *  postinst             #!/bin/sh\n     498 \u5b57\u8282\uff0c   36 \u884c   *  postrm               #!/bin/sh\n Package: dpkg\n Version: 1.19.7\n Architecture: amd64\n Essential: yes\n Maintainer: Dpkg Developers <debian-dpkg@lists.debian.org>\n Installed-Size: 6693\n Pre-Depends: libbz2-1.0, libc6 (>= 2.15), liblzma5 (>= 5.2.2), libselinux1 (>= 2.3), zlib1g (>= 1:1.1.4)\n Depends: tar (>= 1.28-1)\n Suggests: apt, debsig-verify\n Breaks: acidbase (<= 1.4.5-4), amule (<< 2.3.1+git1a369e47-3), beep (<< 1.3-4), im (<< 1:151-4), libapt-pkg5.0 (<< 1.7~b), libdpkg-perl (<< 1.18.11), lsb-base (<< 10.2019031300), netselect (<< 0.3.ds1-27), pconsole (<< 1.0-12), phpgacl (<< 3.3.7-7.3), pure-ftpd (<< 1.0.43-1), systemtap (<< 2.8-1), terminatorx (<< 4.0.1-1), xvt (<= 2.1-20.1)\n Section: admin\n Priority: required\n Multi-Arch: foreign\n Homepage: https://wiki.debian.org/Teams/Dpkg\n Description: Debian package management system\n  This package provides the low-level infrastructure for handling the\n  installation and removal of Debian software packages.\n  .\n  For Debian package development tools, install dpkg-dev.\n")),(0,o.kt)("h2",{id:"\u4ee5-dpkg-deb-\u5305\u4e3a\u4f8b\u67e5\u770b-deb-\u5305\u771f\u5b9e\u5185\u5bb9"},"\u4ee5 dpkg deb \u5305\u4e3a\u4f8b\uff0c\u67e5\u770b deb \u5305\u771f\u5b9e\u5185\u5bb9"),(0,o.kt)("h3",{id:"1-\u4f7f\u7528-ar-\u547d\u4ee4\u89e3\u538b-deb-\u5305"},"1. \u4f7f\u7528 ar \u547d\u4ee4\u89e3\u538b deb \u5305"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# ar -x ../dpkg_1.19.7_amd64.deb \nroot@virt-debian10:/tmp/test# ls\ncontrol.tar.xz  data.tar.xz  debian-binary\n")),(0,o.kt)("h3",{id:"2-\u67e5\u770b-debian-binary-\u6587\u4ef6\u5185\u5bb9"},"2. \u67e5\u770b debian-binary \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# cat ./debian-binary \n2.0\n")),(0,o.kt)("h3",{id:"3-\u67e5\u770b-controltarxz-\u6587\u4ef6\u5185\u5bb9"},"3. \u67e5\u770b control.tar.xz \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# tar -xvf ./control.tar.xz \n./\n./conffiles\n./control\n./md5sums\n./postinst\n./postrm\n")),(0,o.kt)("h4",{id:"31-conffiles-\u6587\u4ef6\u5185\u5bb9"},"3.1 conffiles \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# cat conffiles \n/etc/alternatives/README\n/etc/cron.daily/dpkg\n/etc/dpkg/dpkg.cfg\n/etc/logrotate.d/alternatives\n/etc/logrotate.d/dpkg\n")),(0,o.kt)("p",null,"\u6b64\u6587\u4ef6\u5185\u5bb9\u4e3a\u5305\u7684\u914d\u7f6e\u6587\u4ef6\u5217\u8868\u3002"),(0,o.kt)("h4",{id:"32-control-\u6587\u4ef6\u5185\u5bb9"},"3.2 control \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# cat control\nPackage: dpkg\nVersion: 1.19.7\nArchitecture: amd64\nEssential: yes\nMaintainer: Dpkg Developers <debian-dpkg@lists.debian.org>\nInstalled-Size: 6693\nPre-Depends: libbz2-1.0, libc6 (>= 2.15), liblzma5 (>= 5.2.2), libselinux1 (>= 2.3), zlib1g (>= 1:1.1.4)\nDepends: tar (>= 1.28-1)\nSuggests: apt, debsig-verify\nBreaks: acidbase (<= 1.4.5-4), amule (<< 2.3.1+git1a369e47-3), beep (<< 1.3-4), im (<< 1:151-4), libapt-pkg5.0 (<< 1.7~b), libdpkg-perl (<< 1.18.11), lsb-base (<< 10.2019031300), netselect (<< 0.3.ds1-27), pconsole (<< 1.0-12), phpgacl (<< 3.3.7-7.3), pure-ftpd (<< 1.0.43-1), systemtap (<< 2.8-1), terminatorx (<< 4.0.1-1), xvt (<= 2.1-20.1)\nSection: admin\nPriority: required\nMulti-Arch: foreign\nHomepage: https://wiki.debian.org/Teams/Dpkg\nDescription: Debian package management system\n This package provides the low-level infrastructure for handling the\n installation and removal of Debian software packages.\n .\n For Debian package development tools, install dpkg-dev.\n")),(0,o.kt)("h4",{id:"3-md5sums-\u6587\u4ef6\u5185\u5bb9"},"3. md5sums \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# cat md5sums \n708d64b33f8756aae3f1d0f7a6a2fb54  sbin/start-stop-daemon\n9fd4b4d3254e3dcbc9a5ccab720c62f6  usr/bin/dpkg\nece2aef1292c9f4a25879b7cd6f2c4fb  usr/bin/dpkg-deb\n5daa197d76b1628b363728adbc1cf6bc  usr/bin/dpkg-divert\n5db5f84eef334d26845d752c6087c4a7  usr/bin/dpkg-maintscript-helper\n0e68a2e82688114f42e6fc481d50e43c  usr/bin/dpkg-query\n964a5c7c08ed40ec3ee86077240a6bc0  usr/bin/dpkg-split\n2bb088d154310625d3a98da9a11f6914  usr/bin/dpkg-statoverride\n7bce7162bb939bf55d6f27dfe2eff773  usr/bin/dpkg-trigger\n01b64f08855d55ee2b1f395920d1ac83  usr/bin/update-alternatives\n638083d212928607b198dfb2af90014a  usr/share/bug/dpkg\nf5c2a9458457860e236b648010541d67  usr/share/doc/dpkg/AUTHORS\n.........\n")),(0,o.kt)("p",null,"\u6b64\u6587\u4ef6\u4e2d\u4fdd\u5b58\u5305\u4e2d\u6240\u6709\u5b89\u88c5\u6587\u4ef6\u7684 md5sum \u503c\u3002"),(0,o.kt)("h4",{id:"4-postinst-\u6587\u4ef6\u5185\u5bb9"},"4. postinst \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-\uff53\uff48\uff45\uff4c\uff4c"},'root@virt-debian10:/tmp/test# cat ./postinst \n#!/bin/sh\n# See deb-postinst(5).\n\nset -e\n\n# Create the database files if they don\'t already exist\ncreate_database() {\n    admindir=${DPKG_ADMINDIR:-/var/lib/dpkg}\n\n    for file in diversions statoverride status; do\n    if [ ! -f "$admindir/$file" ]; then\n        touch "$admindir/$file"\n    fi\n    done\n}\n\n\n# Create log file and set default permissions if possible\ncreate_logfile() {\n    logfile=$DPKG_ROOT/var/log/dpkg.log\n\n    if [ ! -f "$logfile" ]; then\n        touch "$logfile"\n        chmod 644 "$logfile"\n        chown root:root "$logfile" 2>/dev/null || chown 0:0 "$logfile"\n    fi\n}\n\n\ncase "$1" in\n    configure)\n    create_database\n    create_logfile\n    ;;\n\n    abort-upgrade|abort-deconfigure|abort-remove)\n    ;;\n\n    *)\n    echo "$0 called with unknown argument \'$1\'" 1>&2\n    exit 1\n    ;;\nesac\n\n\nexit 0\n')),(0,o.kt)("p",null,"\u6b64\u811a\u672c\u7531 deb-postinst \u547d\u4ee4\u5728\u5305\u5b89\u88c5\u5b8c\u6210\u540e\u8c03\u7528\u3002"),(0,o.kt)("h4",{id:"5-postrm-\u6587\u4ef6\u5185\u5bb9"},"5. postrm \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'root@virt-debian10:/tmp/test# cat ./postrm \n#!/bin/sh\n# See deb-postrm(5).\n\nset -e\n\n# Remove log file when dpkg is purged\nremove_logfile() {\n    logdir=$DPKG_ROOT/var/log\n\n    rm -f "$logdir"/dpkg.log "$logdir"/dpkg.log.* 2>/dev/null\n    rm -f "$logdir"/alternatives.log "$logdir"/alternatives.log.* 2>/dev/null\n}\n\ncase "$1" in\n    remove)\n    ;;\n\n    purge)\n    remove_logfile\n    ;;\n\n    upgrade)\n    ;;\n\n    failed-upgrade|disappear|abort-install|abort-upgrade)\n    ;;\n\n\n    *)\n    echo "$0 called with unknown argument \'$1\'" 1>&2\n    exit 1\n    ;;\nesac\n\n\nexit 0\n')),(0,o.kt)("p",null,"\u6b64\u811a\u672c\u88ab deb-postrm \u547d\u4ee4\u5728\u5305\u79fb\u9664\u540e\u8c03\u7528\u3002"),(0,o.kt)("h3",{id:"datatar-\u6587\u4ef6\u5185\u5bb9"},"data.tar \u6587\u4ef6\u5185\u5bb9"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"root@virt-debian10:/tmp/test# tar -tvf ./data.tar.xz \ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/alternatives/\n-rw-r--r-- root/root       100 2019-06-04 05:22 ./etc/alternatives/README\ndrwxr-xr-x root/root         0 2019-06-04 05:22 ./etc/cron.daily/\n-rwxr-xr-x root/root      1187 2019-04-19 10:14 ./etc/cron.daily/dpkg\n.........\n")),(0,o.kt)("p",null,"\u53ef\u4ee5\u770b\u5230 data.tar \u4e2d\u5b58\u50a8\u5305\u4e2d\u6240\u6709\u5b89\u88c5\u6587\u4ef6\u3002"),(0,o.kt)("h2",{id:"dpkg-\u5b89\u88c5\u5305\u7684\u8fc7\u7a0b"},"dpkg \u5b89\u88c5\u5305\u7684\u8fc7\u7a0b"),(0,o.kt)("p",null,"\u901a\u8fc7 dpkg \u547d\u4ee4\u5b89\u88c5 dpkg \u5305\u7684\u7ec8\u7aef\u8f93\u51fa\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"longyu@virt-debian10:/tmp$ sudo dpkg -i ./dpkg_1.19.7_amd64.deb \n(Reading database ... 69152 files and directories currently installed.)\nPreparing to unpack ./dpkg_1.19.7_amd64.deb ...\nUnpacking dpkg (1.19.7) over (1.19.7) ...\nSetting up dpkg (1.19.7) ...\nProcessing triggers for man-db (2.8.5-2) ...\n")),(0,o.kt)("p",null,"man dpkg \u5f97\u5230\u5982\u4e0b\u4fe1\u606f\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-manual"},"              Install the package. If --recursive or -R option is specified, package-file must refer to a directory instead.\n\n              Installation consists of the following steps:\n\n              1. Extract the control files of the new package.\n\n              2. If another version of the same package was installed before the new installation, execute prerm script of the old package.\n\n              3. Run preinst script, if provided by the package.\n\n              4. Unpack the new files, and at the same time back up the old files, so that if something goes wrong, they can be restored.\n\n              5.  If  another version of the same package was installed before the new installation, execute the postrm script of the old package. Note that this script\n              is executed after the preinst script of the new package, because new files are written at the same time old files are removed.\n\n              6. Configure the package. See --configure for detailed information about how this is done.\n")),(0,o.kt)("p",null,"\u603b\u7ed3\u4e00\u4e0b dpkg \u5b89\u88c5\u7684\u6b65\u9aa4\uff1a"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"\u89e3\u538b\u65b0\u5305\u7684\u63a7\u5236\u6587\u4ef6"),(0,o.kt)("li",{parentName:"ol"},"\u626b\u63cf\u6570\u636e\u5e93\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u5b89\u88c5\u4e86\u65b0\u5305\u7684\u5176\u5b83\u7248\u672c\uff0c\u662f\u5219\u6267\u884c\u65e7\u5305\u7684 prerm \u811a\u672c"),(0,o.kt)("li",{parentName:"ol"},"\u5f53\u65b0\u5305\u7684\u63a7\u5236\u6587\u4ef6\u4e2d\u5b58\u5728 preinst \u65f6\uff0c\u6267\u884c\u4e4b"),(0,o.kt)("li",{parentName:"ol"},"\u89e3\u538b\u65b0\u5305\u7684 data.tar \u540c\u65f6\u5907\u4efd\u65e7\u7684\u6587\u4ef6\u7528\u4e8e\u9519\u8bef\u6062\u590d"),(0,o.kt)("li",{parentName:"ol"},"\u5982\u679c\u5728\u6b64\u6b21\u5b89\u88c5\u524d\u76f8\u540c\u5305\u7684\u53e6\u5916\u4e00\u4e2a\u7248\u672c\u5df2\u7ecf\u5b89\u88c5\uff0c\u6267\u884c\u65e7\u5305\u7684 postrm \u811a\u672c"),(0,o.kt)("li",{parentName:"ol"},"\u914d\u7f6e\u5305\uff0c\u89e3\u5305 conffiles \u4e2d\u5217\u4e3e\u7684\u914d\u7f6e\u6587\u4ef6\u540c\u65f6\u5907\u4efd\u65e7\u7684 conffiles \u6587\u4ef6\u7528\u4e8e\u9519\u8bef\u6062\u590d"),(0,o.kt)("li",{parentName:"ol"},"\u5f53\u65b0\u5305\u7684\u63a7\u5236\u6587\u4ef6\u4e2d\u5b58\u5728 postinst \u65f6\uff0c\u6267\u884c\u4e4b")),(0,o.kt)("p",null,"\u5907\u6ce8\uff1a\u65e7\u5305\u7684 postrm \u811a\u672c\u5728\u65b0\u5305\u7684 preinst \u811a\u672c\u6267\u884c\u540e\u6267\u884c\u662f\u7531\u4e8e\u65b0\u6587\u4ef6\u5728\u65e7\u6587\u4ef6\u88ab\u79fb\u9664\u7684\u540c\u65f6\u5199\u5165\uff0c\u5373\u65b0\u5305\u7684 preinst \u811a\u672c\u6267\u884c\u5b8c\u6210\u540e\u76f8\u5f53\u4e8e\u65e7\u5305\u6587\u4ef6\u79fb\u9664\u5b8c\u6210"))}b.isMDXComponent=!0}}]);